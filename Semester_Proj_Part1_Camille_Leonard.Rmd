---
title: "Semester Project Part 1 Camille Leonard"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
knitr::opts_chunk$set(error=TRUE,        # Keep compiling upon error
                      collapse=FALSE,    # collapse by default
                      echo=TRUE,         # echo code by default
                      comment = "#>",    # change comment character
                      fig.width = 7,     # set figure width
                      fig.align = "center",# set figure position
                      out.width = "49%", # set width of displayed images
                      warning=FALSE,     # do not show R warnings
                      message=FALSE)     # do not show R messages
```

```{r}
library(tidyverse)
library(MASS)
library(ggplot2)
library(GGally)
library(yardstick) #for ROC curves...?
library(caret)
library(pROC)
```

```{r}
df <- tibble(read.csv("HaitiPixels.csv"))
anyNA(df)
summary(df)
ggpairs(df[,2:4], lower.panel = NULL)
df$Class <- factor(df$Class)
attach(df)
```

```{r}

#par(las=2)
#boxplot(Red~Class)
#boxplot(Green~Class)
#boxplot(Blue~Class)


featurePlot(x = df[,2:4],
            y = df$Class,
            plot = "box",
            layout = c(3,1), 
            scales = list(y = list(relation = "free"),
                          x = list(rot = 90)))
```

```{r}
df <- cbind(mutate(df, "Blue_Tarp_or_Not"=ifelse(Class != "Blue Tarp", 0, 1)))
Blue_Tarp_or_Not <- as.factor(Blue_Tarp_or_Not)
df
tail(df)
attach(df)
```


```{r}
set.seed(4)
trainIndex <- createDataPartition(Class, p=0.8,
                                  list=FALSE,
                                  times=1)

blueTarpTrain <- df[trainIndex,]
blueTarpTrain$Blue_Tarp_or_Not <- as.factor(blueTarpTrain$Blue_Tarp_or_Not)
blueTarpTest <- df[-trainIndex,]
blueTarpTest$Blue_Tarp_or_Not <- as.factor(blueTarpTest$Blue_Tarp_or_Not)
```


##Logistic Regression 

```{r}
glm.fit <- glm(Blue_Tarp_or_Not~Red+Green+Blue, family = binomial, data=blueTarpTrain)
summary(glm.fit)
glm.prob <- predict(glm.fit, blueTarpTest, type = "response")
glm.pred=ifelse(glm.prob>0.5,1,0)
cm.glm <- confusionMatrix(factor(glm.pred), factor(blueTarpTest$Blue_Tarp_or_Not)) 
cm.glm
#roc(blueTarpTest$Blue_Tarp_or_Not,  ) need to work on this one
```

One vs the rest for logistic regression of different classes 

##LDA 

```{r}
#fitControl <- trainControl(method = "cv")

fitControl <- trainControl(method = "repeatedcv",
                           number = 10,
                           repeats = 10)

set.seed(4)
lda.fit <- caret::train(Blue_Tarp_or_Not~Red+Green+Blue,
                    data = blueTarpTrain,
                    preProcess=c("center","scale"),
                    method="lda",
                    verbose= FALSE,
                    trControl= fitControl)

lda.fit

```

##QDA 

```{r}
fitControl <- trainControl(method = "repeatedcv",
                           number = 10,
                           repeats = 10)

set.seed(4)
qda.fit <- caret::train(Blue_Tarp_or_Not~Red+Green+Blue,
                    data = blueTarpTrain,
                    preProcess=c("center","scale"),
                    method="qda",
                    verbose= FALSE,
                    trControl= fitControl)

qda.fit


```

##KNN
```{r}
fitControl <- trainControl(method = "repeatedcv",
                           number = 10,
                           repeats = 10)

set.seed(4)
knn.fit <- train(Blue_Tarp_or_Not~Red+Green+Blue,
                    data = blueTarpTrain,
                    preProcess=c("center","scale"),
                    method="knn",
                    verbose= FALSE,
                    trControl= fitControl,
                    tuneLength=10
                    )

knn.fit

```


